# 项目变更记录

> 用途：记录每次代码修改的变更摘要、影响范围与时间，便于追踪与回溯。

## 2026-02-17
- 新增规则：每次代码修改后必须同步更新本文件。
- 影响文件：
  - `AGENTS.md`
- 14:30 补齐文件过期清理能力：新增后台定时清理线程，按保留时长自动清理 `output/`、`screenshots/`、`data/tasks/*.json` 与 `data/tasks/checkpoints/*.json`。
- 影响文件：
  - `server/utils/file_manager.py`
  - `server/app.py`
  - `server/config.py`
  - `server/.env.example`
- 14:35 补齐基础自动化测试：新增申请表模板 POC 测试、代码检查器单测、文件清理器单测，并通过 `unittest` 验证。
- 影响文件：
  - `server/tests/test_application_doc_poc.py`
  - `server/tests/test_code_checker.py`
  - `server/tests/test_file_manager.py`
  - `docs/项目变更记录.md`
- 13:09 新增《系统当前架构与流程梳理》文档，系统化梳理前后端分层、核心模块职责、六步流水线、状态存储、降级机制与端到端调用流程。
- 影响文件：
  - `docs/系统当前架构与流程梳理.md`
  - `docs/项目变更记录.md`
- 13:10 通义接口从 OpenAI 兼容模式切换为 DashScope AIGC Text Generation 接口（`/api/v1/services/aigc/text-generation/generation`），并支持 SSE 增量解析。
- 影响文件：
  - `server/ai/adapters/tongyi_adapter.py`
  - `server/config.py`
  - `server/.env.example`
- 13:02 服务端关键接口补充入参/出参日志，覆盖 `/generate`、`/tech-stacks`、`/task`、`/task/<task_id>/stream`、`/task/<task_id>/cancel`、`/download`、`/download/<task_id>/all` 的成功与失败分支，便于排查请求链路。
- 影响文件：
  - `server/api/generate.py`
  - `server/api/task.py`
  - `server/api/download.py`
  - `docs/项目变更记录.md`
