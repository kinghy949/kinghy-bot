# 设计文档 v3.0 未实现功能清单（最小实现单位）

> 基线文档：`docs/设计文档_v3.0.md`  
> 对照代码：`server/`、`client/` 当前实现（核对时间：2026-02-17）

## 判定口径
- 已有“可运行 MVP”但未达到设计文档目标的，标记为“未完全实现”。
- 清单按“最小可实现单位”拆分，每项应可独立开发、提交、验收。

## 实现清单

| ID | 模块 | 最小任务（未实现项） | 主要影响文件 | 验收标准 | 已完成标记 |
|---|---|---|---|---|---|
| T001 | 提示词资源 | 补齐 `server/ai/prompts/feature_gen.txt` 模板文件 | `server/ai/prompts/feature_gen.txt` | 文件存在，可被读取，包含功能清单生成约束。 | 已完成 |
| T002 | 提示词资源 | 补齐 `server/ai/prompts/code_gen.txt` 模板文件 | `server/ai/prompts/code_gen.txt` | 文件存在，可被读取，包含按功能生成代码的约束。 | 已完成 |
| T003 | 提示词资源 | 补齐 `server/ai/prompts/manual_gen.txt` 模板文件 | `server/ai/prompts/manual_gen.txt` | 文件存在，可被读取，包含手册文案生成约束。 | 已完成 |
| T004 | 提示词资源 | 补齐 `server/ai/prompts/page_gen.txt` 模板文件 | `server/ai/prompts/page_gen.txt` | 文件存在，可被读取，包含页面内容生成约束。 | 已完成 |
| T005 | Prompt Builder | 将 `prompt_builder.py` 扩展为“按功能构建代码提示词”接口 | `server/ai/prompt_builder.py` | 提供按 `feature`、`tech_stack`、`existing_files` 生成提示词的方法。 | 已完成 |
| T006 | 代码模板资源 | 为 `springboot_vue` 补齐可渲染模板文件（后端/前端骨架） | `server/code_templates/springboot_vue/**` | 模板目录不为空，包含真实模板文件（非空目录）。 | 已完成 |
| T007 | 代码模板资源 | 为 `flask_vue` 补齐可渲染模板文件（后端/前端骨架） | `server/code_templates/flask_vue/**` | 模板目录不为空，包含真实模板文件。 | 已完成 |
| T008 | 代码模板资源 | 为 `django_vue` 补齐可渲染模板文件（后端/前端骨架） | `server/code_templates/django_vue/**` | 模板目录不为空，包含真实模板文件。 | 已完成 |
| T009 | 代码生成 | `CodeGenerator` 接入 `code_templates_dir`，从模板渲染骨架而非硬编码字符串 | `server/generators/code_generator.py` | 生成代码来源包含模板渲染结果，且占位符被替换。 | 已完成 |
| T010 | 代码生成 | 增加“按 feature 调用 AI 生成业务代码”流程 | `server/generators/code_generator.py` | 每个功能至少触发一次独立生成（可从日志或状态证明）。 | 已完成 |
| T011 | 代码生成 | 生成时传入“已生成文件列表”避免重复产物 | `server/generators/code_generator.py` | 多功能生成后无重复路径覆盖告警。 | 已完成 |
| T012 | 行数策略 | 将行数补充阈值从当前 60% 对齐到设计要求 80% | `server/generators/code_generator.py` | 当总代码 `< 目标80%` 时触发补充逻辑。 | 已完成 |
| T013 | HTML模板资源 | 落地 6 类页面模板文件（login/dashboard/list/form/detail/chart） | `server/html_templates/*.html` | 目录下存在 6 个模板文件并可渲染。 | 已完成 |
| T014 | HTML生成 | `HtmlPageGenerator` 改为读取 `server/html_templates/`（非内联拼接） | `server/generators/html_page_generator.py` | 生成器可按 `page_type` 加载对应模板文件。 | 已完成 |
| T015 | HTML生成 | 增加“AI生成页面内容”并注入模板变量（字段、菜单、数据） | `server/generators/html_page_generator.py` | 页面内容不再固定硬编码，能随功能描述变化。 | 已完成 |
| T016 | 源码文档 | 页脚实现“第X页 共Y页”真实页码（非固定文本） | `server/generators/source_doc_generator.py` | 导出文档页脚可显示当前页与总页数。 | 已完成 |
| T017 | 操作手册 | 增加自动目录（TOC） | `server/generators/manual_doc_generator.py` | 文档含目录域或可更新目录占位。 | 已完成 |
| T018 | 操作手册 | 补齐“安装与配置”章节并从技术栈配置读取安装步骤 | `server/generators/manual_doc_generator.py` | 手册包含 3.1/3.2/3.3 且内容来自 `tech_config`。 | 已完成 |
| T019 | 操作手册 | 补齐“注意事项”章节（5.1/5.2） | `server/generators/manual_doc_generator.py` | 手册包含第5章结构与内容。 | 已完成 |
| T020 | 申请表生成 | 改为“基于 Word 模板占位符替换”，而非新建空白表格文档 | `server/generators/application_doc_generator.py` | 读取模板并替换字段，输出保持模板结构。 | 已完成 |
| T021 | 申请表生成 | 对不可自动填字段做“模板内高亮标注” | `server/generators/application_doc_generator.py` | 指定字段在输出文档中可见黄色高亮提示。 | 已完成 |
| T022 | 取消任务 | 补齐“运行中任务可取消”的协作式取消机制（非仅 `Future.cancel()`） | `server/task/task_manager.py`, `server/generators/orchestrator.py` | 任务进入 `processing` 后仍可被取消并尽快停止。 | 已完成 |
| T023 | 自动化测试 | 新增 `test_ai_client.py`（重试与主备切换） | `server/tests/test_ai_client.py` | 测试可运行并覆盖主备切换/重试分支。 | 已完成 |
| T024 | 自动化测试 | 新增 `test_generators.py`（关键生成器最小集成） | `server/tests/test_generators.py` | 覆盖至少 feature/code/html/doc 主要路径。 | 已完成 |
| T025 | 自动化测试 | 新增 `test_screenshot.py`（Playwright失败降级占位图） | `server/tests/test_screenshot.py` | 验证失败时仍返回占位图路径。 | 已完成 |
| T026 | 自动化测试 | 新增 `test_consistency.py`（警告/错误判定） | `server/tests/test_consistency.py` | 覆盖缺代码、缺截图、占位图、行数不足分支。 | 已完成 |
| T027 | 端到端验证 | 增加 3 技术栈端到端回归脚本或测试用例 | `server/tests/**` | `springboot_vue`、`flask_vue`、`django_vue` 各至少跑通一次生成与下载。 | 未完成 |

## 备注（当前已实现但常被误判为未实现）
- 线程池任务管理、JSON 状态持久化、checkpoint 恢复：已实现。
- SSE 推送与前端轮询降级：已实现。
- 文件定时清理：已实现（`FileManager` + `FileCleanupWorker`）。
- 申请表 POC 基础读写测试：已实现（`server/tests/test_application_doc_poc.py`）。
